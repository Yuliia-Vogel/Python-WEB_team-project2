{% extends "base.html" %}

{% load custom_filters %}

{% block content %}
  <h2>Your Uploaded Files</h2>
  <ul>
    {% for file in files %}
      <li>
        <a href="{{ file.file_url }}" target="_blank">{{ file.file_url|basename }}</a> (uploaded at {{ file.uploaded_at }})

        {% with file_extension=file.file_url|lower|slice:'-3:' %}
          {% if file_extension in "pdf txt jpg jpeg png gif svg webp mp4 webm ogg mp3 wav" %}
            <a href="{{ file.file_url }}" target="_blank" class="btn btn-secondary">View</a>
          {% endif %}
        {% endwith %}

        <a href="{% url 'files:download_file' file.id %}">Download file</a>

      </li>
    {% empty %}
      <li>No files uploaded yet.</li>
    {% endfor %}
  </ul>
  <a href="{% url 'files:upload_file' %}">Upload new file</a>
{% endblock %}